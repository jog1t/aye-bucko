name: Deploy game

on: push

jobs:
   build--black-pearl:
      name: Build Black Pearl (game frontend)
      runs-on: self-hosted
      steps:
         - uses: actions/checkout@v2
         - uses: actions/setup-node@v2
           with:
              node-version: '14'
         - run: npm -g install yarn
         - run: yarn install
         - run: cd black-pearl && yarn build
         - uses: actions/upload-artifact@v2
           with:
            name: black-pearl
            path: black-pearl/build
   build--whydah:
      name: Build Whydah (game backend)
      runs-on: self-hosted
      steps:
        - uses: actions/checkout@v2
        - uses: actions/setup-node@v2
          with:
             node-version: '14'
        - run: npm -g install yarn
        - run: yarn install
        - run: cd whydah && yarn build
        - uses: actions/upload-artifact@v2
          with:
             name: whydah
             path: whydah/build

   deploy:
      name: Deploy
      runs-on: self-hosted
      needs:
         - build--black-pearl
         - build--whydah
      steps:
         - run: echo Hello!
